<!DOCTYPE html> <html><head>
		<title>nix-language</title>
		<base href="../">
		<meta id="root-path" root-path="../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="Notes - nix-language">
		<meta property="og:title" content="nix-language">
		<meta property="og:description" content="Notes - nix-language">
		<meta property="og:type" content="website">
		<meta property="og:url" content="https://soymadip.me/notes/nix/nix-language.html">
		<meta property="og:image" content="undefined">
		<meta property="og:site_name" content="Notes">
		<meta name="author" content="soymadip"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://soymadip.me/notes/lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon outliner-plugin-dnd ctp-macchiato ctp-accent-maroon ctp-bold-folder-title"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Nix language basics"><p dir="auto">Nix language basics</p></h1><div class="el-p"><p dir="auto">(reading-nix-language)=</p></div><div class="el-h1 heading-wrapper"><div class="heading-children"><div class="el-p"><p dir="auto">The Nix language is designed for conveniently creating and composing <em>derivations</em> – precise descriptions of how contents of existing files are used to derive new files.<br>
It is a domain-specific, purely functional, lazily evaluated, dynamically typed programming language.</p></div><div class="el-p"><p dir="auto">:::{admonition} Notable uses of the Nix language<br>
:class: note</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p>{term}<code>Nixpkgs</code></p>
<p>The largest, most up-to-date software distribution in the world, and written in the Nix language.</p>
</li>
<li data-line="4" dir="auto">
<p>{term}<code>NixOS</code></p>
<p>A Linux distribution that can be configured fully declaratively and is based on Nix and Nixpkgs.</p>
<p>Its underlying modular configuration system is written in the Nix language, and uses packages from Nixpkgs.<br>
The operating system environment and services it provides are configured with the Nix language.</p>
</li>
</ul></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">You may quickly encounter Nix language expressions that look very complicated.<br>
As with any programming language, the required amount of Nix language code closely matches the complexity of the problem it is supposed to solve, and reflects how well the problem – and its solution – is understood.<br>
Building software is a complex undertaking, and Nix both <em>exposes</em> and <em>allows managing</em> this complexity with the Nix language.</p></div><div class="el-p"><p dir="auto">Yet, the Nix language itself has only few basic concepts that will be introduced in this tutorial, and which can be combined arbitrarily.<br>
What may look complicated comes not from the language, but from how it is used.</p></div><div class="el-h2 heading-wrapper"><h2 data-heading="Overview" dir="auto" class="heading" id="Overview"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Overview</h2><div class="heading-children"><div class="el-p"><p dir="auto">This is an introduction to <strong>reading the Nix language</strong>, for the purpose of following other tutorials and examples.</p></div><div class="el-p"><p dir="auto"><strong>Using the Nix language</strong> in practice entails multiple things:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Language: syntax and semantics</li>
<li data-line="1" dir="auto">Libraries: <code>builtins</code> and <code>pkgs.lib</code></li>
<li data-line="2" dir="auto">Developer tools: testing, debugging, linting, formatting, ...</li>
<li data-line="3" dir="auto">Generic build mechanisms: <code>stdenv.mkDerivation</code>, trivial builders, ...</li>
<li data-line="4" dir="auto">Composition and configuration mechanisms: <code>override</code>, <code>overrideAttrs</code>, overlays, <code>callPackage</code>, ...</li>
<li data-line="5" dir="auto">Ecosystem-specific packaging mechanisms: <code>buildGoModule</code>, <code>buildPythonApplication</code>, ...</li>
<li data-line="6" dir="auto">NixOS module system: <code>config</code>, <code>option</code>, ...</li>
</ul></div><div class="el-p"><p dir="auto">This tutorial only covers the most important language features, briefly discusses libraries, and at the end will direct you to reference material and resources on the other components.</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="What will you learn?" dir="auto" class="heading" id="What_will_you_learn?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>What will you learn?</h3><div class="heading-children"><div class="el-p"><p dir="auto">This tutorial should enable you to read typical Nix language code and understand its structure.<br>
Its goal is to highlight where the Nix language may differ from languages you are used to.</p></div><div class="el-p"><p dir="auto">It therefore shows the most common and distinguishing patterns in the Nix language:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a class="internal-link" data-href="names-values" href="names-values" target="_self" rel="noopener nofollow">Assigning names and accessing values</a></li>
<li data-line="1" dir="auto">Declaring and calling <a class="internal-link" data-href="functions" href="functions" target="_self" rel="noopener nofollow">functions</a></li>
<li data-line="2" dir="auto"><a class="internal-link" data-href="libraries" href="libraries" target="_self" rel="noopener nofollow">Built-in and library functions</a></li>
<li data-line="3" dir="auto"><a class="internal-link" data-href="impurities" href="impurities" target="_self" rel="noopener nofollow">Impurities</a> to obtain build inputs</li>
<li data-line="4" dir="auto"><a class="internal-link" data-href="derivations" href="derivations" target="_self" rel="noopener nofollow">Derivations</a> that describe build tasks</li>
</ul></div><div class="el-p"><p dir="auto">:::{important}<br>
This tutorial <em>does not</em> explain all Nix language features in detail and <em>does not</em> go into specifics of syntactical rules.</p></div><div class="el-p"><p dir="auto">See the <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/index.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/index.html" target="_blank">Nix manual</a> for a full language reference.<br>
:::</p></div><div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="What do you need?" dir="auto" class="heading" id="What_do_you_need?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>What do you need?</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Familiarity with software development</li>
<li data-line="1" dir="auto">Familiarity with Unix shell, to read command line examples </li>
<li data-line="2" dir="auto">A {ref}<code>Nix installation &lt;install-nix&gt;</code> to run the examples</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="How long does it take?" dir="auto" class="heading" id="How_long_does_it_take?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>How long does it take?</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">No experience with functional programming: 2 hours</li>
<li data-line="1" dir="auto">Familiar with functional programming: 1 hour</li>
<li data-line="2" dir="auto">Proficient with functional programming: 30 minutes</li>
</ul></div><div class="el-p"><p dir="auto">We recommend to run all examples.<br>
Play with them to validate your assumptions and test what you have learned.<br>
Read detailed explanations if you want to make sure you fully understand the examples.</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="How to run the examples?" dir="auto" class="heading" id="How_to_run_the_examples?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>How to run the examples?</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">A piece of Nix language code is a <em>Nix expression</em>.</li>
<li data-line="1" dir="auto">Evaluating a Nix expression produces a <em>Nix value</em>.</li>
<li data-line="2" dir="auto">The content of a <em>Nix file</em> (file extension <code>.nix</code>) is a Nix expression.</li>
</ul></div><div class="el-p"><p dir="auto">:::{note}<br>
To <em>evaluate</em> means to transform an expression into a value according to the language rules.<br>
:::</p></div><div class="el-p"><p dir="auto">This tutorial contains many examples of Nix expressions.<br>
Each one is followed by the expected evaluation result.</p></div><div class="el-p"><p dir="auto">The following example is a Nix expression adding two numbers:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
1 + 2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h4 heading-wrapper"><h4 data-heading="Interactive evaluation" dir="auto" class="heading" id="Interactive_evaluation"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Interactive evaluation</h4><div class="heading-children"><div class="el-p"><p dir="auto">Use <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" target="_blank"><code>nix repl</code></a> to evaluate Nix expressions interactively (by typing them on the command line):</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix repl</span></span>
<span class="token output">Welcome to Nix 2.13.3. Type :? for help.

nix-repl&gt; 1 + 2
3
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{note}<br>
The Nix language uses lazy evaluation, and <code>nix repl</code> by default only computes values when needed.</p></div><div class="el-p"><p dir="auto">Some examples show a fully evaluated data structure for clarity.<br>
If your output does not match the example, try prepending <code>:p</code> to the input expression.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token output">nix-repl&gt; { a.b.c = 1; }
{ a = { ... }; }

nix-repl&gt; :p { a.b.c = 1; }
{ a = { b = { c = 1; }; }; }
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Type <code>:q</code> to exit <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" target="_blank"><code>nix repl</code></a>.</p></div><div class="el-p"><p dir="auto">:::</p></div><div></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Evaluating Nix files" dir="auto" class="heading" id="Evaluating_Nix_files"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Evaluating Nix files</h4><div class="heading-children"><div class="el-p"><p dir="auto">Use <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/command-ref/nix-instantiate.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/command-ref/nix-instantiate.html" target="_blank"><code>nix-instantiate --eval</code></a> to evaluate the expression in a Nix file.</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token number">1</span> + <span class="token number">2</span> <span class="token operator">&gt;</span> file.nix</span></span>
<span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval file.nix</span></span>
<span class="token output">3
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">The first command writes <code>1 + 2</code> to a file <code>file.nix</code> in the current directory.<br>
The contents of <code>file.nix</code> are now <code>1 + 2</code>, which you can check with</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">cat</span> file.nix</span></span>
<span class="token output">1 + 2
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The second command runs <code>nix-instantiate</code> with the <code>--eval</code> option on <code>file.nix</code>, which reads the file and evaluates the contained Nix expression.<br>
The resulting value is printed as output.</p></div><div class="el-p"><p dir="auto"><code>--eval</code> is required to evaluate the file and do nothing else.<br>
If <code>--eval</code> is omitted, <code>nix-instantiate</code> expects the expression in the given file to evaluate to a special value called a <em>derivation</em>, which we will come back to at the end of this tutorial in <a class="internal-link" data-href="derivations" href="derivations" target="_self" rel="noopener nofollow"></a>.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">:::{note}<br>
<code>nix-instantiate --eval</code> will try to read from <code>default.nix</code> if no file name is specified.</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token number">1</span> + <span class="token number">2</span> <span class="token operator">&gt;</span> default.nix</span></span>
<span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval</span></span>
<span class="token output">3
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">:::{note}<br>
The Nix language uses lazy evaluation, and <code>nix-instantiate</code> by default only computes values when needed.</p></div><div class="el-p"><p dir="auto">Some examples show a fully evaluated data structure for clarity.<br>
If your output does not match the example, try adding the <code>--strict</code> option to <code>nix-instantiate</code>.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"{ a.b.c = 1; }"</span> <span class="token operator">&gt;</span> file.nix</span></span>
<span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval file.nix</span></span>
<span class="token output">{ a = &lt;CODE&gt;; }
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"{ a.b.c = 1; }"</span> <span class="token operator">&gt;</span> file.nix</span></span>
<span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval --strict file.nix</span></span>
<span class="token output">{ a = { b = { c = 1; }; }; }
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Notes on whitespace" dir="auto" class="heading" id="Notes_on_whitespace"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Notes on whitespace</h3><div class="heading-children"><div class="el-p"><p dir="auto">White space is used to delimit <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Lexical_analysis#Lexical_token_and_lexical_tokenization" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Lexical_analysis#Lexical_token_and_lexical_tokenization" target="_blank">lexical tokens</a>, where required.<br>
It is otherwise insignificant.</p></div><div></div><div class="el-p"><p dir="auto">Line breaks, indentation, and additional spaces are for readers' convenience.</p></div><div class="el-p"><p dir="auto">The following are equivalent:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
 x = 1;
 y = 2;
in x + y
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let x=1;y=2;in x+y
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(names-values)=</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Names and values" dir="auto" class="heading" id="Names_and_values"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Names and values</h2><div class="heading-children"><div class="el-p"><p dir="auto">Values in the Nix language can be primitive data types, lists, attribute sets, and functions.</p></div><div class="el-p"><p dir="auto">We show examples of primitive data types and lists in the context of <a class="internal-link" data-href="attrset" href="attrset" target="_self" rel="noopener nofollow">attribute sets</a>.<br>
Later in this section we cover special features of character strings: <a class="internal-link" data-href="string-interpolation" href="string-interpolation" target="_self" rel="noopener nofollow">string interpolation</a>, <a class="internal-link" data-href="file-system-paths" href="file-system-paths" target="_self" rel="noopener nofollow">file system paths</a>, and <a class="internal-link" data-href="indented-strings" href="indented-strings" target="_self" rel="noopener nofollow">indented strings</a>.<br>
We deal with <a class="internal-link" data-href="functions" href="functions" target="_self" rel="noopener nofollow">functions</a> separately.</p></div><div class="el-p"><p dir="auto"><a class="internal-link" data-href="attrset" href="attrset" target="_self" rel="noopener nofollow">Attribute sets</a> and <a class="internal-link" data-href="let" href="let" target="_self" rel="noopener nofollow"><code>let</code> expressions</a> are used to assign names to values.<br>
Assignments are denoted by a single equal sign (<code>=</code>).</p></div><div class="el-p"><p dir="auto">Whenever you encounter an equal sign (<code>=</code>) in Nix language code:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">On its left is the assigned name.</li>
<li data-line="1" dir="auto">On its right is the value, delimited by a semicolon (<code>;</code>).</li>
</ul></div><div class="el-p"><p dir="auto">(attrset)=</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Attribute set `{ ... }`" dir="auto" class="heading" id="Attribute_set_`{_..._}`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Attribute set <code>{ ... }</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">An attribute set is a collection of name-value-pairs, where names must be unique.</p></div><div class="el-p"><p dir="auto">The following example shows all primitive data types, lists, and attribute sets.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
If you are familiar with JSON, imagine the Nix language as <em>JSON with functions</em>.</p></div><div class="el-p"><p dir="auto">Nix language data types <em>without functions</em> work just like their counterparts in JSON and look very similar.<br>
:::</p></div><div class="el-p"><p dir="auto">::::{grid} 2</p></div><div class="el-p"><p dir="auto">:::{grid-item} <strong>Nix</strong></p></div><div class="el-pre"><pre class="language-nix" tabindex="0"><code data-line="0" class="language-nix is-loaded"><span class="token punctuation">{</span>
  string <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
  integer <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  float <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token number">141</span><span class="token punctuation">;</span>
  bool <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  list <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">1</span> <span class="token string">"two"</span> <span class="token boolean">false</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
  attribute<span class="token operator">-</span>set <span class="token operator">=</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    c <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token number">718</span><span class="token punctuation">;</span>
    d <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment"># comments are supported</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">:::{grid-item} <strong>JSON</strong></p></div><div class="el-pre"><pre class="language-json" tabindex="0"><code data-line="0" class="language-json is-loaded"><span class="token punctuation">{</span>
  <span class="token property">"string"</span><span class="token operator">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span>
  <span class="token property">"integer"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"float"</span><span class="token operator">:</span> <span class="token number">3.141</span><span class="token punctuation">,</span>
  <span class="token property">"bool"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"null"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"object"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"a"</span><span class="token operator">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span>
    <span class="token property">"b"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"c"</span><span class="token operator">:</span> <span class="token number">2.718</span><span class="token punctuation">,</span>
    <span class="token property">"d"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">::::</p></div><div class="el-p"><p dir="auto">:::{note}</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Attribute names usually do not need quotes.<sup data-footnote-id="fnref-1-6daef11852f765c4" class="footnote-ref" id="fnref-1-6daef11852f765c4"><a data-footref="attrnames" href="#fn-1-6daef11852f765c4" class="footnote-link" target="_self" rel="noopener nofollow">[1]</a></sup></li>
<li data-line="1" dir="auto">List elements are separated by white space.<sup data-footnote-id="fnref-2-6daef11852f765c4" class="footnote-ref" id="fnref-2-6daef11852f765c4"><a data-footref="list-whitespace" href="#fn-2-6daef11852f765c4" class="footnote-link" target="_self" rel="noopener nofollow">[2]</a></sup><br>
:::</li>
</ul></div><div></div><div></div><div class="el-p"><p dir="auto">(rec-attrset)=</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Recursive attribute set `rec { ... }`" dir="auto" class="heading" id="Recursive_attribute_set_`rec_{_..._}`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Recursive attribute set <code>rec { ... }</code></h4><div class="heading-children"><div class="el-p"><p dir="auto">You will sometimes see attribute sets declared with <code>rec</code> prepended.<br>
This allows access to attributes from within the set.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
rec {
  one = 1;
  two = one + 1;
  three = two + 1;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ one = 1; three = 3; two = 2; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{note}<br>
Elements in an attribute set can be declared in any order, and are ordered on evaluation.<br>
:::</p></div><div class="el-p"><p dir="auto">Counter-example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{
  one = 1;
  two = one + 1;
  three = two + 1;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
error: undefined variable 'one'

       at «string»:3:9:

            2|   one = 1;
            3|   two = one + 1;
             |         ^
            4|   three = two + 1;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(let)=</p></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="`let ... in ...`" dir="auto" class="heading" id="`let_..._in_...`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>let ... in ...</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “<code>let</code> expression” or “<code>let</code> binding”</p></div><div class="el-p"><p dir="auto"><code>let</code> expressions allow assigning names to values for repeated use.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = 1;
in
a + a
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">Assignments are placed between the keywords <code>let</code> and <code>in</code>.<br>
In this example we assign <code>a = 1</code>.</p></div><div class="el-p"><p dir="auto">After <code>in</code> comes the expression in which the assignments are valid, i.e., where assigned names can be used.<br>
In this example the expression is <code>a + a</code>, where <code>a</code> refers to <code>a = 1</code>.</p></div><div class="el-p"><p dir="auto">By replacing the names with their assigned values, <code>a + a</code> evaluates to <code>2</code>.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">Names can be assigned in any order, and expressions on the right of the assignment (<code>=</code>) can refer to other assigned names.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  b = a + 1;
  a = 1;
in
a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">Assignments are placed between the keywords <code>let</code> and <code>in</code>.<br>
In this example we assign <code>a = 1</code> and <code>b = a + 1</code>.</p></div><div class="el-p"><p dir="auto">The order of assignments does not matter.<br>
Therefore the following example, where the assignments are in reverse order, is equivalent:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = 1;
  b = a + 1;
in
a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Note that the <code>a</code> in <code>b = a + 1</code> refers to <code>a = 1</code>.</p></div><div class="el-p"><p dir="auto">After <code>in</code> comes the expression in which the assignments are valid.<br>
In this example the expression is <code>a + b</code>, where <code>a</code> refers to <code>a = 1</code>, and <code>b</code> refers to <code>b = a + 1</code>.</p></div><div class="el-p"><p dir="auto">By replacing the names with their assigned values, <code>a + b</code> evaluates to <code>3</code>.</p></div><div class="el-p"><p dir="auto">This is similar to <a class="internal-link" data-href="rec-attrset" href="rec-attrset" target="_self" rel="noopener nofollow">recursive attribute sets</a>:<br>
in both, the order of assignments does not matter, and names on the left can be used in expressions on the right of the assignment (<code>=</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-p"><p dir="auto">::::{grid} 2</p></div><div class="el-p"><p dir="auto">:::{grid-item} <code>let ... in ...</code></p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  b = a + 1;
  c = a + b;
  a = 1;
in {  c = c; a = a; b = b; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ a = 1; b = 2; c = 3; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">:::{grid-item} <code>rec { ... }</code></p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
rec {
  b = a + 1;
  c = a + b;
  a = 1;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ a = 1; b = 2; c = 3; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">::::</p></div><div class="el-p"><p dir="auto">The difference is that while a recursive attribute set evaluates to an <a class="internal-link" data-href="attrset" href="attrset" target="_self" rel="noopener nofollow">attribute set</a>, any expression can follow after the <code>in</code> keyword.</p></div><div class="el-p"><p dir="auto">In the following example we use the <code>let</code> expression to form a list:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  b = a + 1;
  c = a + b;
  a = 1;
in [ a b c ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
[ 1 2 3 ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::::</p></div><div class="el-p"><p dir="auto">Only expressions within the <code>let</code> expression itself can access the newly declared names.<br>
We say: the bindings have local scope.</p></div><div class="el-p"><p dir="auto">Counter-example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{
  a = let x = 1; in x;
  b = x;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
error: undefined variable 'x'

       at «string»:3:7:

            2|   a = let x = 1; in x;
            3|   b = x;
             |       ^
            4| }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Attribute access" dir="auto" class="heading" id="Attribute_access"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Attribute access</h3><div class="heading-children"><div class="el-p"><p dir="auto">Attributes in a set are accessed with a dot (<code>.</code>) and the attribute name.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  attrset = { x = 1; };
in
attrset.x
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Accessing nested attributes works the same way.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  attrset = { a = { b = { c = 1; }; }; };
in
attrset.a.b.c
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The dot (<code>.</code>) notation can also be used for assigning attributes.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{ a.b.c = 1; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ a = { b = { c = 1; }; }; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(with)=</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="`with ...; ...`" dir="auto" class="heading" id="`with_...;_...`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>with ...; ...</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">The <code>with</code> expression allows access to attributes without repeatedly referencing their attribute set.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = {
    x = 1;
    y = 2;
    z = 3;
  };
in
with a; [ x y z ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
[ 1 2 3 ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The expression</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">with a; [ x y z ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">is equivalent to</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">[ a.x a.y a.z ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Attributes made available through <code>with</code> are only in scope of the expression following the semicolon (<code>;</code>).</p></div><div class="el-p"><p dir="auto">Counter-example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = {
    x = 1;
    y = 2;
    z = 3;
  };
in
{
  b = with a; [ x y z ];
  c = x;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
error: undefined variable 'x'

       at «string»:10:7:

            9|   b = with a; [ x y z ];
           10|   c = x;
             |       ^
           11| }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(inherit)=</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="`inherit ...`" dir="auto" class="heading" id="`inherit_...`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>inherit ...</code></h3><div class="heading-children"><div class="el-p"><p dir="auto"><code>inherit</code> is shorthand for assigning the value of a name from an existing scope to the same name in a nested scope.<br>
It is for convenience to avoid repeating the same name multiple times.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  x = 1;
  y = 2;
in
{
  inherit x y;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ x = 1; y = 2; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The fragment</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">inherit x y;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">is equivalent to</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">x = x; y = y;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">It is also possible to <code>inherit</code> names from a specific attribute set with parentheses (<code>inherit (...) ...</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = { x = 1; y = 2; };
in
{
  inherit (a) x y;
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
{ x = 1; y = 2; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The fragment</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">inherit (a) x y;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">is equivalent to</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">x = a.x; y = a.y;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><code>inherit</code> also works inside <code>let</code> expressions.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  inherit ({ x = 1; y = 2; }) x y;
in [ x y ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
[ 1 2 ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">While this example is contrived, in more complex code you will regularly see nested <code>let</code> expressions that re-use names from their outer scope.</p></div><div class="el-p"><p dir="auto">Here we use the attribute set <code>{ x = 1; y = 2; }</code> to have something non-trivial to inherit from.<br>
The <code>let</code> expression inherits <code>x</code> and <code>y</code> from that attribute set using <code>( )</code>, which is equivalent to writing:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">let
  x = { x = 1; y = 2; }.x;
  y = { x = 1; y = 2; }.y;
in
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The new inner scope now contains <code>x</code> and <code>y</code>, which are used in the list <code>[ x y ]</code>.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">(string-interpolation)=</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="String interpolation `${ ... }`" dir="auto" class="heading" id="String_interpolation_`${_..._}`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>String interpolation <code>${ ... }</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">Previously known as “antiquotation”.</p></div><div class="el-p"><p dir="auto">The value of a Nix expression can be inserted into a character string with the dollar-sign and braces (<code>${ }</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  name = "Nix";
in
"hello ${name}"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"hello Nix"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Only character strings or values that can be represented as a character string are allowed.</p></div><div class="el-p"><p dir="auto">Counter-example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  x = 1;
in
"${x} + ${x} = ${x + x}"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
error: cannot coerce an integer to a string

       at «string»:4:2:

            3| in
            4| "${x} + ${x} = ${x + x}"
             |  ^
            5|
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Interpolated expressions can be arbitrarily nested.</p></div><div class="el-p"><p dir="auto">(This can become hard to read, and we recommend to avoid it in practice.)</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  a = "no";
in
"${a + " ${a + " ${a}"}"}"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"no no no"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{warning}<br>
You may encounter strings that use the dollar sign (<code>$</code>) before an assigned name, but no braces (<code>{ }</code>):</p></div><div class="el-p"><p dir="auto">These are <em>not</em> interpolated strings, but usually denote variables in a shell script.</p></div><div class="el-p"><p dir="auto">In such cases, the use of names from the surrounding Nix expression is a coincidence.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  out = "Nix";
in
"echo ${out} &gt; $out"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"echo Nix &gt; $out"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div></div><div class="el-p"><p dir="auto">(file-system-paths)=</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="File system paths" dir="auto" class="heading" id="File_system_paths"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>File system paths</h3><div class="heading-children"><div class="el-p"><p dir="auto">The Nix language offers convenience syntax for file system paths.</p></div><div class="el-p"><p dir="auto">Absolute paths always start with a slash (<code>/</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
/absolute/path
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/absolute/path
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Paths are relative when they contain at least one slash (<code>/</code>) but do not start with one.<br>
They evaluate to the path relative to the file containing the expression.</p></div><div class="el-p"><p dir="auto">The following examples assume the containing Nix file is in <code>/current/directory</code> (or <code>nix repl</code> is run in <code>/current/directory</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
./relative
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/current/directory/relative
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
relative/path
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/current/directory/relative/path
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">One dot (<code>.</code>) denotes the current directory within the given path.</p></div><div class="el-p"><p dir="auto">You will often see the following expression, which specifies a Nix file's directory.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
./.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/current/directory
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">Since relative paths must contain a slash (<code>/</code>) but must not start with one, and the dot (<code>.</code>) denotes no change of directory, the combination <code>./.</code> specifies the current directory as a relative path.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">Two dots (<code>..</code>) denote the parent directory.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
../.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/current
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{note}<br>
Paths can be used in interpolated expressions – an <a class="internal-link" data-href="impurities" href="impurities" target="_self" rel="noopener nofollow">impure operation</a> we will cover in detail in a <a class="internal-link" data-href="path-impurities" href="path-impurities" target="_self" rel="noopener nofollow">later section</a>.<br>
:::</p></div><div class="el-p"><p dir="auto">(lookup-path-tutorial)=</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Lookup paths" dir="auto" class="heading" id="Lookup_paths"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Lookup paths</h4><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “angle bracket syntax”.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
&lt;nixpkgs&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/nix/var/nix/profiles/per-user/root/channels/nixpkgs
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The value of a <a data-tooltip-position="top" aria-label="https://nixos.org/manual/nix/unstable/language/constructs/lookup-path" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nix/unstable/language/constructs/lookup-path" target="_blank">lookup path</a> is a file system path that depends on the value of <a data-tooltip-position="top" aria-label="https://nixos.org/manual/nix/stable/language/builtin-constants#builtins-nixPath" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nix/stable/language/builtin-constants#builtins-nixPath" target="_blank"><code>builtins.nixPath</code></a>.</p></div><div class="el-p"><p dir="auto">In practice, <code>&lt;nixpkgs&gt;</code> points to the file system path of some revision of {term}<code>Nixpkgs</code>.</p></div><div class="el-p"><p dir="auto">For example, <code>&lt;nixpkgs/lib&gt;</code> points to the subdirectory <code>lib</code> of that file system path:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
&lt;nixpkgs/lib&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
/nix/var/nix/profiles/per-user/root/channels/nixpkgs/lib
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">While you will encounter many such examples, we recommend to <a class="internal-link" data-href="search-path" href="search-path" target="_self" rel="noopener nofollow">avoid lookup paths</a> in production code, as they are <a class="internal-link" data-href="impurities" href="impurities" target="_self" rel="noopener nofollow">impurities</a> which are not reproducible.</p></div><div></div><div></div><div class="el-p"><p dir="auto">[manual-primitives]: <a rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/values.html#primitives" target="_blank">https://nix.dev/manual/nix/2.18/language/values.html#primitives</a></p></div><div class="el-p"><p dir="auto">(indented-strings)=</p></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Indented strings" dir="auto" class="heading" id="Indented_strings"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Indented strings</h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “multi-line strings”.</p></div><div class="el-p"><p dir="auto">The Nix language offers convenience syntax for character strings which span multiple lines that have common indentation.</p></div><div class="el-p"><p dir="auto">Indented strings are denoted by <em>double single quotes</em> (<code>'' ''</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
''
multi
line
string
''
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"multi\nline\nstring\n"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Equal amounts of prepended white space are trimmed from the result.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
''
  one
   two
    three
''
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"one\n two\n  three\n"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div></div><div class="el-p"><p dir="auto">(functions)=</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Functions" dir="auto" class="heading" id="Functions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Functions</h2><div class="heading-children"><div class="el-p"><p dir="auto">Functions are everywhere in the Nix language and deserve particular attention.</p></div><div class="el-p"><p dir="auto">A function always takes exactly one argument.<br>
Argument and function body are separated by a colon (<code>:</code>).</p></div><div class="el-p"><p dir="auto">Wherever you find a colon (<code>:</code>) in Nix language code:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">On its left is the function argument</li>
<li data-line="1" dir="auto">On its right is the function body.</li>
</ul></div><div class="el-p"><p dir="auto">Function arguments are the third way, apart from <a class="internal-link" data-href="attrset" href="attrset" target="_self" rel="noopener nofollow">attribute sets</a> and <a class="internal-link" data-href="let" href="let" target="_self" rel="noopener nofollow"><code>let</code> expressions</a>, to assign names to values.<br>
Notably, values are not known in advance: the names are placeholders that are filled when <a class="internal-link" data-href="calling-functions" href="calling-functions" target="_self" rel="noopener nofollow">calling a function</a>.</p></div><div class="el-p"><p dir="auto">Function declarations in the Nix language can appear in different forms.<br>
Each of them is explained in the following, and here is an overview:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Single argument</p>
<pre class="language-none" tabindex="0"><code data-line="2" class="language-{code-block} language-none is-loaded">x: x + 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<ul>
<li data-line="6" dir="auto">
<p>Multiple arguments via nesting</p>
<pre class="language-none" tabindex="0"><code data-line="8" class="language-{code-block} language-none is-loaded">x: y: x + y
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
</ul>
</li>
<li data-line="12" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Attribute set argument</p>
<pre class="language-none" tabindex="0"><code data-line="14" class="language-{code-block} language-none is-loaded">{ a, b }: a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<ul>
<li data-line="18" dir="auto">
<p>With default attributes</p>
<pre class="language-none" tabindex="0"><code data-line="20" class="language-{code-block} language-none is-loaded">{ a, b ? 0 }: a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
<li data-line="24" dir="auto">
<p>With additional attributes allowed</p>
<pre class="language-none" tabindex="0"><code data-line="26" class="language-{code-block} language-none is-loaded">{ a, b, ...}: a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
</ul>
</li>
<li data-line="30" dir="auto">
<p>Named attribute set argument</p>
<pre class="language-none" tabindex="0"><code data-line="32" class="language-{code-block} language-none is-loaded">args@{ a, b, ... }: a + b + args.c
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
<p>or</p>
<pre class="language-none" tabindex="0"><code data-line="38" class="language-{code-block} language-none is-loaded">{ a, b, ... }@args: a + b + args.c
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre>
</li>
</ul></div><div class="el-p"><p dir="auto">Functions have no names.<br>
We say they are anonymous, and call such a function a <em>lambda</em>.<sup data-footnote-id="fnref-3-6daef11852f765c4" class="footnote-ref" id="fnref-3-6daef11852f765c4"><a data-footref="lambda" href="#fn-3-6daef11852f765c4" class="footnote-link" target="_self" rel="noopener nofollow">[3]</a></sup></p></div><div></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
x: x + 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The <code>&lt;LAMBDA&gt;</code> indicates the resulting value is an anonymous function.</p></div><div class="el-p"><p dir="auto">As with any other value, functions can be assigned to a name.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: x + 1;
in f
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(calling-functions)=</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Calling functions" dir="auto" class="heading" id="Calling_functions"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Calling functions</h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as "function application".</p></div><div class="el-p"><p dir="auto">Calling a function with an argument means writing the argument after the function.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: x + 1;
in f 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: x.a;
in
f { a = 1; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The above example calls <code>f</code> on a literal attribute set.<br>
One can also pass arguments by name.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: x.a;
  v = { a = 1; };
in
f v
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Since function and argument are separated by white space, sometimes parentheses (<code>( )</code>) are required to achieve the desired result.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
(x: x + 1) 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">This expression applies an anonymous function <code>x: x + 1</code> to the argument <code>1</code>.<br>
The function has to be written in parentheses to distinguish it from the argument.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-p"><p dir="auto">List elements are also separated by white space, therefore the following are different:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
 f = x: x + 1;
 a = 1;
in [ (f a) ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
[ 2 ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
 f = x: x + 1;
 a = 1;
in [ f a ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
[ &lt;LAMBDA&gt; 1 ]
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The first example reads: apply <code>f</code> to <code>a</code>, and put the result in a list.<br>
The resulting list has one element.</p></div><div class="el-p"><p dir="auto">The second example reads: put <code>f</code> and <code>a</code> in a list.<br>
The resulting list has two elements.</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="Multiple arguments" dir="auto" class="heading" id="Multiple_arguments"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Multiple arguments</h4><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “<a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Currying" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Currying" target="_blank">curried</a> functions”.</p></div><div class="el-p"><p dir="auto">Nix functions take exactly one argument.<br>
Multiple arguments can be handled by nesting functions.</p></div><div class="el-p"><p dir="auto">Such a nested function can be used like a function that takes multiple arguments, but offers additional flexibility.</p></div><div></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
x: y: x + y
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The above function is equivalent to</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
x: (y: x + y)
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This function takes one argument and returns another function <code>y: x + y</code> with <code>x</code> set to the value of that argument.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: y: x + y;
in
f 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Applying the function which results from <code>f 1</code> to another argument yields the inner body <code>x + y</code> (with <code>x</code> set to <code>1</code> and <code>y</code> set to the other argument), which can now be fully evaluated.</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = x: y: x + y;
in
f 1 2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Attribute set argument" dir="auto" class="heading" id="Attribute_set_argument"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Attribute set argument</h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “keyword arguments” or “destructuring” .</p></div><div class="el-p"><p dir="auto">Nix functions can be declared to require an attribute set with specific structure as argument.</p></div><div class="el-p"><p dir="auto">This is denoted by listing the expected attribute names separated by commas (<code>,</code>) and enclosed in braces (<code>{ }</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{a, b}: a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The argument defines the exact attributes that have to be in that set.<br>
Leaving out or passing additional attributes is an error.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a, b}: a + b;
in
f { a = 1; b = 2; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Counter-example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a, b}: a + b;
in
f { a = 1; b = 2; c = 3; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
error: 'f' at (string):2:7 called with unexpected argument 'c'

       at «string»:4:1:

            3| in
            4| f { a = 1; b = 2; c = 3; }
             | ^
            5|
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Default values" dir="auto" class="heading" id="Default_values"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Default values</h4><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “default arguments”.</p></div><div class="el-p"><p dir="auto">Destructured arguments can have default values for attributes.</p></div><div class="el-p"><p dir="auto">This is denoted by separating the attribute name and its default value with a question mark (<code>?</code>).</p></div><div class="el-p"><p dir="auto">Attributes in the argument are not required if they have a default value.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a, b ? 0}: a + b;
in
f { a = 1; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a ? 0, b ? 0}: a + b;
in
f { } # empty attribute set
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
0
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="Additional attributes" dir="auto" class="heading" id="Additional_attributes"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Additional attributes</h4><div class="heading-children"><div class="el-p"><p dir="auto">Additional attributes are allowed with an ellipsis (<code>...</code>):</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{a, b, ...}: a + b
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Unlike in the previous counter-example, passing an argument that contains additional attributes is not an error.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a, b, ...}: a + b;
in
f { a = 1; b = 2; c = 3; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Named attribute set argument" dir="auto" class="heading" id="Named_attribute_set_argument"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Named attribute set argument</h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “@ pattern”, “@ syntax”, or “‘at’ syntax”.</p></div><div class="el-p"><p dir="auto">An attribute set argument can be given a name to be accessible as a whole.</p></div><div class="el-p"><p dir="auto">This is denoted by prepending or appending the name to the attribute set argument, separated by the at sign (<code>@</code>).</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{a, b, ...}@args: a + b + args.c
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">or</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
args@{a, b, ...}: a + b + args.c
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  f = {a, b, ...}@args: a + b + args.c;
in
f { a = 1; b = 2; c = 3; }
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
6
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">(libraries)=</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Function libraries" dir="auto" class="heading" id="Function_libraries"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Function libraries</h2><div class="heading-children"><div class="el-p"><p dir="auto">In addition to the [built-in operators][operators] (<code>+</code>, <code>==</code>, <code>&amp;&amp;</code>, etc.), there are two widely used libraries that <em>together</em> can be considered standard for the Nix language.<br>
You need to know about both to understand and navigate Nix language code.</p><div><pre class="dataview dataview-error">Dataview (inline field '='): Error: 
-- PARSING FAILED --------------------------------------------------

&gt; 1 | =
    | ^

Expected one of the following: 

'(', 'null', boolean, date, duration, file link, list ('[1, 2, 3]'), negated field, number, object ('{ a: 1, b: 2 }'), string, variable
</pre></div></div><div></div><div class="el-p"><p dir="auto">We recommend to at least skim them to familiarise yourself with what is available.</p></div><div class="el-p"><p dir="auto">[operators]: <a rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/operators.html" target="_blank">https://nix.dev/manual/nix/2.18/language/operators.html</a></p></div><div class="el-p"><p dir="auto">(builtins)=</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="`builtins`" dir="auto" class="heading" id="`builtins`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>builtins</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">Also known as “primitive operations” or “primops”.</p></div><div class="el-p"><p dir="auto">Nix comes with many functions that are built into the language.<br>
They are implemented in C++ as part of the Nix language interpreter.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
The Nix manual lists all [Built-in Functions][nix-builtins], and shows how to use them.<br>
:::</p></div><div class="el-p"><p dir="auto">These functions are available under the <code>builtins</code> constant.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
builtins.toString
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;PRIMOP&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div></div><div class="el-p"><p dir="auto">[nix-builtins]: <a rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/builtins.html" target="_blank">https://nix.dev/manual/nix/2.18/language/builtins.html</a></p></div><div class="el-p"><p dir="auto">(reading-nix-language-import)=</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="`import`" dir="auto" class="heading" id="`import`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>import</code></h4><div class="heading-children"><div class="el-p"><p dir="auto">Most built-in functions are only accessible through <code>builtins</code>.<br>
A notable exception is <code>import</code>, which is also available at the top level.</p></div><div class="el-p"><p dir="auto"><code>import</code> takes a path to a Nix file, reads it to evaluate the contained Nix expression, and returns the resulting value.<br>
If the path points to a directory, the file <code>default.nix</code> in that directory is used instead.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token number">1</span> + <span class="token number">2</span> <span class="token operator">&gt;</span> file.nix</span></span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
import ./file.nix
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">The preceding shell command writes the contents <code>1 + 2</code> to the file <code>file.nix</code> in the current directory.</p></div><div class="el-p"><p dir="auto">The above Nix expression refers to this file as <code>./file.nix</code>.<br>
<code>import</code> reads the file and evaluates to the contained Nix expression.</p></div><div class="el-p"><p dir="auto">It is an error if the file system path does not exist.</p></div><div class="el-p"><p dir="auto">After reading <code>file.nix</code> the Nix expression is equivalent to the file contents:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
1 + 2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
3
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">Since a Nix file can contain any Nix expression, <code>import</code>ed functions can be applied to arguments immediately.</p></div><div class="el-p"><p dir="auto">That is, whenever you find additional tokens after a call to <code>import</code>, the value it returns should be a function, and anything that follows are arguments to that function.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"x: x + 1"</span> <span class="token operator">&gt;</span> file.nix</span></span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
import ./file.nix 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">::::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">The preceding shell command writes the contents <code>x: x + 1</code> to the file <code>file.nix</code> in the current directory.</p></div><div class="el-p"><p dir="auto">The above Nix expression refers to this file as <code>./file.nix</code>.<br>
<code>import ./file.nix</code> reads the file and evaluates to the contained Nix expression.</p></div><div class="el-p"><p dir="auto">It is an error if the file system path does not exist.</p></div><div class="el-p"><p dir="auto">After reading the file, the Nix expression <code>import ./file.nix</code> is equivalent to the file contents:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
(x: x + 1) 1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
2
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This applies the function <code>x: x + 1</code> to the argument <code>1</code>, and therefore evaluates to <code>2</code>.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
Parentheses are required to separate function declaration from function application.<br>
:::</p></div><div class="el-p"><p dir="auto">::::</p></div><div class="el-p"><p dir="auto">(pkgs-lib)=</p></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="`pkgs.lib`" dir="auto" class="heading" id="`pkgs.lib`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><code>pkgs.lib</code></h3><div class="heading-children"><div class="el-p"><p dir="auto">The <a data-tooltip-position="top" aria-label="https://github.com/NixOS/nixpkgs" rel="noopener nofollow" class="external-link" href="https://github.com/NixOS/nixpkgs" target="_blank"><code>nixpkgs</code></a> repository contains an attribute set called <a data-tooltip-position="top" aria-label="https://github.com/NixOS/nixpkgs/blob/master/lib/default.nix" rel="noopener nofollow" class="external-link" href="https://github.com/NixOS/nixpkgs/blob/master/lib/default.nix" target="_blank"><code>lib</code></a>, which provides a large number of useful functions.<br>
They are implemented in the Nix language, as opposed to <a class="internal-link" data-href="builtins" href="builtins" target="_self" rel="noopener nofollow"><code>builtins</code></a>, which are part of the language itself.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
The Nixpkgs manual lists all <a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#sec-functions-library" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#sec-functions-library" target="_blank">Nixpkgs library functions</a>.<br>
:::</p></div><div></div><div></div><div class="el-p"><p dir="auto">These functions are usually accessed through <code>pkgs.lib</code>, as the Nixpkgs attribute set is given the name <code>pkgs</code> by convention.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.lib.strings.toUpper "lookup paths considered harmful"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
LOOKUP PATHS CONSIDERED HARMFUL
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">This is a more complex example, but by now you should be familiar with all its components.</p></div><div class="el-p"><p dir="auto">The name <code>pkgs</code> is declared to be the expression <code>import</code>ed from some file.<br>
That file's path is determined by the value of the lookup path <code>&lt;nixpkgs&gt;</code>, which in turn is determined by the <code>$NIX_PATH</code> environment variable at the time this expression is evaluated.<br>
As this expression happens to be a function, it requires an argument to evaluate, and in this case passing an empty attribute set <code>{}</code> is sufficient.</p></div><div class="el-p"><p dir="auto">Now that <code>pkgs</code> is in scope of <code>let ... in ...</code>, its attributes can be accessed.<br>
From the Nixpkgs manual one can determine that there exists a function under <a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#function-library-lib.strings.toUpper" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#function-library-lib.strings.toUpper" target="_blank"><code>lib.strings.toUpper</code></a>.</p></div><div></div><div class="el-p"><p dir="auto">For brevity, this example uses a lookup path to obtain <em>some version</em> of Nixpkgs.<br>
The function <code>toUpper</code> is trivial enough that we can expect it not to produce different results for different versions of Nixpkgs.<br>
Yet, more sophisticated software is likely to suffer from such problems.<br>
A fully reproducible example would therefore look like this:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  nixpkgs = fetchTarball "https://github.com/NixOS/nixpkgs/archive/06278c77b5d162e62df170fec307e83f1812d94b.tar.gz";
  pkgs = import nixpkgs {};
in
pkgs.lib.strings.toUpper "always pin your sources"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
ALWAYS PIN YOUR SOURCES
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">See <a class="internal-link" data-href="pinning-nixpkgs" href="pinning-nixpkgs" target="_self" rel="noopener nofollow"></a> for details.</p></div><div class="el-p"><p dir="auto">What you will also often see is that <code>pkgs</code> is passed as an argument to a function.<br>
By convention one can assume that it refers to the Nixpkgs attribute set, which has a <code>lib</code> attribute:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{ pkgs, ... }:
pkgs.lib.strings.removePrefix "no " "no true scotsman"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To make this function produce a result, you can write it to a file (e.g. <code>file.nix</code>) and pass it an argument through <code>nix-instantiate</code>:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval file.nix --arg pkgs <span class="token string">'import &lt;nixpkgs&gt; {}'</span></span></span>
<span class="token output">"true scotsman"
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Oftentimes you will see in NixOS configurations, and also within Nixpkgs, that <code>lib</code> is passed directly.<br>
In that case one can assume that this <code>lib</code> is equivalent to <code>pkgs.lib</code> where only <code>pkgs</code> is available.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
{ lib, ... }:
let
  to-be = true;
in
lib.trivial.or to-be (! to-be)
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
&lt;LAMBDA&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To make this function produce a result, you can write it to a file (e.g. <code>file.nix</code>) and pass it an argument through <code>nix-instantiate</code>:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">nix-instantiate --eval file.nix --arg lib <span class="token string">'(import &lt;nixpkgs&gt; {}).lib'</span></span></span>
<span class="token output">true
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Sometimes both <code>pkgs</code> and <code>lib</code> are passed as arguments.<br>
In that case, one can assume <code>pkgs.lib</code> and <code>lib</code> to be equivalent.<br>
This is done to improve readability by avoiding repeated use of <code>pkgs.lib</code>.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{ pkgs, lib, ... }:
# ... multiple uses of `pkgs`
# ... multiple uses of `lib`
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">For historical reasons, some of the functions in <code>pkgs.lib</code> are equivalent to <a class="internal-link" data-href="builtins" href="builtins" target="_self" rel="noopener nofollow"><code>builtins</code></a> of the same name.</p></div><div class="el-p"><p dir="auto">(impurities)=</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Impurities" dir="auto" class="heading" id="Impurities"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Impurities</h2><div class="heading-children"><div class="el-p"><p dir="auto">So far we have only covered what we call <em>pure expressions</em>:<br>
declaring data and transforming it with functions.</p></div><div class="el-p"><p dir="auto">In practice, describing derivations requires observing the outside world.</p></div><div class="el-p"><p dir="auto">There is only one impurity in the Nix language that is relevant here:<br>
reading files from the file system as <em>build inputs</em></p></div><div class="el-p"><p dir="auto">Build inputs are files that derivations refer to in order to describe how to derive new files.<br>
When run, a derivation will only have access to explicitly declared build inputs.</p></div><div class="el-p"><p dir="auto">The only way to specify build inputs in the Nix language is explicitly with:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">File system paths</li>
<li data-line="1" dir="auto">Dedicated functions.</li>
</ul></div><div class="el-p"><p dir="auto">Nix and the Nix language refer to files by their content hash. If file contents are not known in advance, it's unavoidable to read files during expression evaluation.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
Nix supports other types of impure expressions, such as <a class="internal-link" data-href="search-path" href="search-path" target="_self" rel="noopener nofollow">lookup paths</a> or the constant <a data-tooltip-position="top" aria-label="https://nixos.org/manual/nix/stable/language/builtin-constants.html#builtins-currentSystem" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nix/stable/language/builtin-constants.html#builtins-currentSystem" target="_blank"><code>builtins.currentSystem</code></a>.<br>
We do not cover those here in more detail, as they do not matter for how the Nix language works in principle, and because they are discouraged for the very reason of breaking reproducibility.<br>
:::</p></div><div class="el-p"><p dir="auto">(path-impurities)=</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Paths" dir="auto" class="heading" id="Paths"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Paths</h3><div class="heading-children"><div class="el-p"><p dir="auto">Whenever a file system path is used in <a class="internal-link" data-href="string-interpolation" href="string-interpolation" target="_self" rel="noopener nofollow">string interpolation</a>, the contents of that file are copied to a special location in the file system, the <em>Nix store</em>, as a side effect.</p></div><div class="el-p"><p dir="auto">The evaluated string then contains the Nix store path assigned to that file.</p></div><div></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-shell-session" tabindex="0"><code data-line="0" class="language-shell-session is-loaded"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">echo</span> <span class="token number">123</span> <span class="token operator">&gt;</span> data</span></span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
"${./data}"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"/nix/store/h1qj5h5n05b5dl5q4nldrqq8mdg7dhqk-data"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">The preceding shell command writes the characters <code>123</code> to the file <code>data</code> in the current directory.</p></div><div class="el-p"><p dir="auto">The above Nix expression refers to this file as <code>./data</code> and converts the file system path to an <a class="internal-link" data-href="string-interpolation" href="string-interpolation" target="_self" rel="noopener nofollow">interpolated string</a> <code>${ ... }</code>.</p></div><div class="el-p"><p dir="auto">Such interpolated expressions must evaluate to something that can be represented as a character string.<br>
A file system path is such a value, and its character string representation is the corresponding Nix store path:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">/nix/store/&lt;hash&gt;-&lt;name&gt;
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">The Nix store path is obtained by taking the hash of the file's contents (<code>&lt;hash&gt;</code>) and combining it with the file name (<code>&lt;name&gt;</code>).<br>
The file is copied into the Nix store directory <code>/nix/store</code> as a side effect of evaluation.<br>
It is an error if the file system path does not exist.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">For directories the same thing happens: The entire directory (including nested files and directories) is copied to the Nix store, and the evaluated string becomes the Nix store path of the directory.</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Fetchers" dir="auto" class="heading" id="Fetchers"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Fetchers</h3><div class="heading-children"><div class="el-p"><p dir="auto">Files to be used as build inputs do not have to come from the file system.</p></div><div class="el-p"><p dir="auto">The Nix language provides built-in impure functions to fetch files over the network during evaluation:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchurl" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchurl" target="_blank"><code>builtins.fetchurl</code></a></li>
<li data-line="1" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchTarball" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchTarball" target="_blank"><code>builtins.fetchTarball</code></a></li>
<li data-line="2" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchGit" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchGit" target="_blank"><code>builtins.fetchGit</code></a></li>
<li data-line="3" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchClosure" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/builtins.html#builtins-fetchClosure" target="_blank"><code>builtins.fetchClosure</code></a></li>
</ul></div><div class="el-p"><p dir="auto">These functions evaluate to a file system path in the Nix store.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
builtins.fetchurl "https://github.com/NixOS/nix/archive/7c3ab5751568a0bc63430b33a5169c5e4784a0ff.tar.gz"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"/nix/store/7dhgs330clj36384akg86140fqkgh8zf-7c3ab5751568a0bc63430b33a5169c5e4784a0ff.tar.gz"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Some of them add extra convenience, such as automatically unpacking archives.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
builtins.fetchTarball "https://github.com/NixOS/nix/archive/7c3ab5751568a0bc63430b33a5169c5e4784a0ff.tar.gz"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"/nix/store/d59llm96vgis5fy231x6m7nrijs0ww36-source"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{note}<br>
The Nixpkgs manual on [Fetchers][nixpkgs-fetchers] lists numerous additional library functions to fetch files over the network.<br>
:::</p></div><div class="el-p"><p dir="auto">It is an error if the network request fails.</p></div><div class="el-p"><p dir="auto">[nixpkgs-fetchers]: <a rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-pkgs-fetchers" target="_blank">https://nixos.org/manual/nixpkgs/stable/#chap-pkgs-fetchers</a></p></div><div class="el-p"><p dir="auto">(derivations)=</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Derivations" dir="auto" class="heading" id="Derivations"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Derivations</h2><div class="heading-children"><div class="el-p"><p dir="auto">Derivations are at the core of both Nix and the Nix language:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">The Nix language is used to describe derivations.</li>
<li data-line="1" dir="auto">Nix runs derivations to produce <em>build results</em>.</li>
<li data-line="2" dir="auto">Build results can in turn be used as inputs for other derivations.</li>
</ul></div><div class="el-p"><p dir="auto">The Nix language primitive to declare a derivation is the built-in impure function <code>derivation</code>.</p></div><div class="el-p"><p dir="auto">It is usually wrapped by the Nixpkgs build mechanism <code>stdenv.mkDerivation</code>, which hides much of the complexity involved in non-trivial build procedures.</p></div><div class="el-p"><p dir="auto">:::{note}<br>
You will probably never encounter <code>derivation</code> in practice.<br>
:::</p></div><div class="el-p"><p dir="auto">Whenever you encounter <code>mkDerivation</code>, it denotes something that Nix will eventually <em>build</em>.</p></div><div class="el-p"><p dir="auto">Example: <a class="internal-link" data-href="mkDerivation-example" href="mkDerivation-example" target="_self" rel="noopener nofollow">a package using <code>mkDerivation</code></a></p></div><div class="el-p"><p dir="auto">The evaluation result of <code>derivation</code> (and <code>mkDerivation</code>) is an <a class="internal-link" data-href="attrset" href="attrset" target="_self" rel="noopener nofollow">attribute set</a> with a certain structure and a special property:<br>
It can be used in <a class="internal-link" data-href="string-interpolation" href="string-interpolation" target="_self" rel="noopener nofollow">string interpolation</a>, and in that case evaluates to the Nix store path of its build result.</p></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: expression
let
  pkgs = import &lt;nixpkgs&gt; {};
in "${pkgs.nix}"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">:class: value
"/nix/store/sv2srrjddrp2isghmrla8s6lazbzmikd-nix-2.11.0"
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">:::{note}<br>
Your output may differ.<br>
It may produce a different hash or even a different package version.</p></div><div class="el-p"><p dir="auto">A derivation's output path is fully determined by its inputs, which in this case come from <em>some</em> version of Nixpkgs.</p></div><div class="el-p"><p dir="auto">This is why we recommend to <a class="internal-link" data-href="search-path" href="search-path" target="_self" rel="noopener nofollow">avoid lookup paths</a> to ensure predictable outcomes, except in examples intended for illustration only.<br>
:::</p></div><div class="el-p"><p dir="auto">:::{dropdown} Detailed explanation</p></div><div class="el-p"><p dir="auto">The example imports the Nix expression from the lookup path <code>&lt;nixpkgs&gt;</code>, and applies the resulting function to an empty attribute set <code>{}</code>.<br>
Its output is assigned the name <code>pkgs</code>.</p></div><div class="el-p"><p dir="auto">Converting the attribute <code>pkgs.nix</code> to a string with <a class="internal-link" data-href="string-interpolation" href="string-interpolation" target="_self" rel="noopener nofollow">string interpolation</a> is allowed, as <code>pkgs.nix</code> is a derivation.<br>
That is, ultimately <code>pkgs.nix</code> boils down to a call to <code>derivation</code>.</p></div><div class="el-p"><p dir="auto">The resulting string is the file system path where the build result of that derivation will end up.</p></div><div class="el-p"><p dir="auto">There is more depth to the inner workings of derivations, but at this point it should be enough to know that such expressions evaluate to Nix store paths.</p></div><div class="el-p"><p dir="auto">:::</p></div><div class="el-p"><p dir="auto">String interpolation on derivations is used to refer to their build results as file system paths when declaring new derivations.</p></div><div class="el-p"><p dir="auto">This allows constructing arbitrarily complex compositions of derivations with the Nix language.</p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Worked examples" dir="auto" class="heading" id="Worked_examples"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Worked examples</h2><div class="heading-children"><div class="el-p"><p dir="auto">So far we have seen artificial examples illustrating the various constructs in the Nix language.</p></div><div class="el-p"><p dir="auto">You should now be able to read Nix language code for simple packages and configurations, and come up with similar explanations of the following practical examples.</p></div><div class="el-p"><p dir="auto">::: {note}<br>
The goal of the following exercises is not to understand what the code means or how it works, but how it is structured in terms of functions, attribute sets, and other Nix language data types.<br>
:::</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Shell environment" dir="auto" class="heading" id="Shell_environment"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Shell environment</h3><div class="heading-children"><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{ pkgs ? import &lt;nixpkgs&gt; {} }:
let
  message = "hello world";
in
pkgs.mkShellNoCC {
  buildInputs = with pkgs; [ cowsay ];
  shellHook = ''
    cowsay ${message}
  '';
}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This example declares a shell environment (which runs the <code>shellHook</code> on initialization).</p></div><div class="el-p"><p dir="auto">Explanation:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">This expression is a function that takes an attribute set as an argument.</li>
<li data-line="1" dir="auto">If the argument has the attribute <code>pkgs</code>, it will be used in the function body.<br>
Otherwise, by default, import the Nix expression in the file found on the lookup path <code>&lt;nixpkgs&gt;</code> (which is a function in this case), call the function with an empty attribute set, and use the resulting value.</li>
<li data-line="3" dir="auto">The name <code>message</code> is bound to the string value <code>"hello world"</code>.</li>
<li data-line="4" dir="auto">The attribute <code>mkShellNoCC</code> of the <code>pkgs</code> set is a function that is passed an attribute set as argument.<br>
Its return value is also the result of the outer function.</li>
<li data-line="6" dir="auto">The attribute set passed to <code>mkShellNoCC</code> has the attributes <code>buildInputs</code> (set to a list with one element: the <code>cowsay</code> attribute from <code>pkgs</code>) and <code>shellHook</code> (set to an indented string).</li>
<li data-line="7" dir="auto">The indented string contains an interpolated expression, which will expand the value of <code>message</code> to yield <code>"hello world"</code>.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="NixOS configuration" dir="auto" class="heading" id="NixOS_configuration"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>NixOS configuration</h3><div class="heading-children"><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{ config, pkgs, ... }: {

  imports = [ ./hardware-configuration.nix ];

  environment.systemPackages = with pkgs; [ git ];

  # ...

}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This example is (part of) a NixOS configuration.</p></div><div class="el-p"><p dir="auto">Explanation:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">
<p>This expression is a function that takes an attribute set as an argument.<br>
It returns an attribute set.</p>
</li>
<li data-line="2" dir="auto">
<p>The argument must at least have the attributes <code>config</code> and <code>pkgs</code>, and may have more attributes.</p>
</li>
<li data-line="3" dir="auto">
<p>The returned attribute set contains the attributes <code>imports</code> and <code>environment</code>.</p>
</li>
<li data-line="4" dir="auto">
<p><code>imports</code> is a list with one element: a path to a file next to this Nix file, called <code>hardware-configuration.nix</code>.</p>
<p>:::{note}<br>
<code>imports</code> is not the impure built-in <code>import</code>, but a regular attribute name!<br>
:::</p>
</li>
<li data-line="9" dir="auto">
<p><code>environment</code> is itself an attribute set with one attribute <code>systemPackages</code>, which will evaluate to a list with one element: the <code>git</code> attribute from the <code>pkgs</code> set.</p>
</li>
<li data-line="10" dir="auto">
<p>The <code>config</code> argument is not (shown to be) used.</p>
</li>
</ul></div><div class="el-p"><p dir="auto">(mkDerivation-example)=</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Package" dir="auto" class="heading" id="Package"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Package</h3><div class="heading-children"><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{ lib, stdenv, fetchurl }:

stdenv.mkDerivation rec {

  pname = "hello";

  version = "2.12";

  src = fetchurl {
    url = "mirror://gnu/${pname}/${pname}-${version}.tar.gz";
    sha256 = "1ayhp9v4m4rdhjmnl2bq3cibrbqqkgjbl3s7yk2nhlh8vj3ay16g";
  };

  meta = with lib; {
    license = licenses.gpl3Plus;
  };

}
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This example is a (simplified) package declaration from Nixpkgs.</p></div><div class="el-p"><p dir="auto">Explanation:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">This expression is a function that takes an attribute set which must have exactly the attributes <code>lib</code>, <code>stdenv</code>, and <code>fetchurl</code>.</li>
<li data-line="1" dir="auto">It returns the result of evaluating the function <code>mkDerivation</code>, which is an attribute of <code>stdenv</code>, applied to a recursive set.</li>
<li data-line="2" dir="auto">The recursive set passed to <code>mkDerivation</code> uses its own <code>pname</code> and <code>version</code> attributes in the argument to the function <code>fetchurl</code>.<br>
<code>fetchurl</code> itself comes from the outer function's arguments.</li>
<li data-line="4" dir="auto">The <code>meta</code> attribute is itself an attribute set, where the <code>license</code> attribute has the value that was assigned to the nested attribute <code>lib.licenses.gpl3Plus</code>.</li>
</ul></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="References" dir="auto" class="heading" id="References"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>References</h2><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/index.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/index.html" target="_blank">Nix manual: Nix language</a></li>
<li data-line="1" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/string-interpolation.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/string-interpolation.html" target="_blank">Nix manual: String interpolation</a></li>
<li data-line="2" dir="auto">[Nix manual: Built-in Functions][nix-builtins]</li>
<li data-line="3" dir="auto"><a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/command-ref/new-cli/nix3-repl.html" target="_blank">Nix manual: <code>nix repl</code></a></li>
<li data-line="4" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#sec-functions-library" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#sec-functions-library" target="_blank">Nixpkgs manual: Functions reference</a></li>
<li data-line="5" dir="auto">[Nixpkgs manual: Fetchers][nixpkgs-fetchers]</li>
</ul></div><div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Next steps" dir="auto" class="heading" id="Next_steps"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Next steps</h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Get things done" dir="auto" class="heading" id="Get_things_done"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Get things done</h3><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a class="internal-link" data-href="declarative-reproducible-envs" href="declarative-reproducible-envs" target="_self" rel="noopener nofollow"></a> – create reproducible shell environments from a Nix file</li>
<li data-line="1" dir="auto"><a class="internal-link" data-href="./packaging-existing-software.md" href="./packaging-existing-software.md" target="_self" rel="noopener nofollow"></a> – make more software available through Nix</li>
</ul></div><div class="el-p"><p dir="auto">If you want to take a longer break from learning Nix, you can remove unused build results from the Nix store with:</p></div><div class="el-pre"><pre class="language-console" tabindex="0"><code data-line="0" class="language-console is-loaded">$ nix-collect-garbage
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Learn more" dir="auto" class="heading" id="Learn_more"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Learn more</h3><div class="heading-children"><div class="el-p"><p dir="auto">If you worked through the examples, you will have noticed that reading the Nix language reveals the structure of the code, but does not necessarily tell what the code actually means.</p></div><div class="el-p"><p dir="auto">Often it is not possible to determine from the code at hand</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">the data type of a named value or function argument.</li>
<li data-line="1" dir="auto">the data type a called function accepts for its argument.</li>
<li data-line="2" dir="auto">which attributes are present in a given attribute set.</li>
</ul></div><div class="el-p"><p dir="auto">Example:</p></div><div class="el-pre"><pre class="language-none" tabindex="0"><code data-line="0" class="language-{code-block} language-none is-loaded">{ x, y, z }: (x y) z.a
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">How do we know...</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">that <code>x</code> will be a function that, given an argument, returns a function?</li>
<li data-line="1" dir="auto">that, given <code>x</code> is a function, <code>y</code> will be an appropriate argument to <code>x</code>?</li>
<li data-line="2" dir="auto">that, given <code>(x y)</code> is a function, <code>z.a</code> will be an appropriate argument to <code>(x y)</code>?</li>
<li data-line="3" dir="auto">that <code>z</code> will be an attribute set at all?</li>
<li data-line="4" dir="auto">that, given <code>z</code> is an attribute set, it will have an attribute <code>a</code>?</li>
<li data-line="5" dir="auto">which data type <code>y</code> and <code>z.a</code> will be?</li>
<li data-line="6" dir="auto">the data type of the end result?</li>
</ul></div><div class="el-p"><p dir="auto">And how does the caller of this function know that it requires an attribute set with attributes <code>x</code>, <code>y</code>, <code>z</code>?</p></div><div class="el-p"><p dir="auto">Answering such questions requires knowing the context in which a given expression is supposed to be used.</p></div><div class="el-p"><p dir="auto">The Nix ecosystem and code style is driven by conventions.<br>
Most names you will encounter in Nix language code come from Nixpkgs:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/guides/nix-pills/" rel="noopener nofollow" class="external-link" href="https://nixos.org/guides/nix-pills/" target="_blank">Nix Pills</a> - a detailed explanation of derivations and how Nixpkgs is constructed from first principles</li>
</ul></div><div class="el-p"><p dir="auto">Nixpkgs provides generic build mechanisms that are widely used:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#chap-stdenv" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-stdenv" target="_blank"><code>stdenv</code></a> - most importantly <code>mkDerivation</code></li>
<li data-line="1" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#chap-trivial-builders" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-trivial-builders" target="_blank">Trivial Builders</a> - to create files and shell scripts</li>
</ul></div><div class="el-p"><p dir="auto">Packages from Nixpkgs can be modified through multiple mechanisms:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#chap-overrides" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-overrides" target="_blank">overrides</a> – specifically <code>override</code> and <code>overrideAttrs</code> to modify single packages</li>
<li data-line="1" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#chap-overlays" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-overlays" target="_blank">overlays</a> – to produce a custom variant of Nixpkgs with individually modified packages</li>
</ul></div><div class="el-p"><p dir="auto">Different language ecosystems and frameworks have different requirements to accommodating them into Nixpkgs:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixpkgs/stable/#chap-language-support" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixpkgs/stable/#chap-language-support" target="_blank">Languages and frameworks</a> lists tools provided by Nixpkgs to build language- or framework-specific packages with Nix.</li>
</ul></div><div class="el-p"><p dir="auto">The NixOS Linux distribution has a modular configuration system that imposes its own conventions:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><a data-tooltip-position="top" aria-label="https://nixos.org/manual/nixos/stable/index.html#sec-writing-modules" rel="noopener nofollow" class="external-link" href="https://nixos.org/manual/nixos/stable/index.html#sec-writing-modules" target="_blank">NixOS modules</a> shows how NixOS configurations are organized.</li>
</ul></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div>
</div><div class="el-section"><section class="footnotes"><hr><ol>
<li data-line="-1789" data-footnote-id="fn-1-6daef11852f765c4" id="fn-1-6daef11852f765c4" dir="auto"><p>Details: <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/values.html#attribute-set" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/values.html#attribute-set" target="_blank">Nix manual - attribute set</a><a href="#fnref-1-6daef11852f765c4" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
<li data-line="-1788" data-footnote-id="fn-2-6daef11852f765c4" id="fn-2-6daef11852f765c4" dir="auto"><p>Details: <a data-tooltip-position="top" aria-label="https://nix.dev/manual/nix/2.18/language/values.html#list" rel="noopener nofollow" class="external-link" href="https://nix.dev/manual/nix/2.18/language/values.html#list" target="_blank">Nix manual - list</a><a href="#fnref-2-6daef11852f765c4" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
<li data-line="-1020" data-footnote-id="fn-3-6daef11852f765c4" id="fn-3-6daef11852f765c4" dir="auto"><p>The term <em>lambda</em> is a shorthand for <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Lambda_calculus#lambdaAbstr" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Lambda_calculus#lambdaAbstr" target="_blank">lambda abstraction</a> in the <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Lambda_calculus" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Lambda_calculus" target="_blank">lambda calculus</a>.<a href="#fnref-3-6daef11852f765c4" class="footnote-backref footnote-link" target="_self" rel="noopener nofollow">↩︎</a></p></li>
</ol></section></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="nix/nix-language.html#Nix language basics"><div class="tree-item-contents heading-link" heading-name="Nix language basics"><span class="tree-item-title">Nix language basics</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Overview"><div class="tree-item-contents heading-link" heading-name="Overview"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Overview</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#What_will_you_learn?"><div class="tree-item-contents heading-link" heading-name="What will you learn?"><span class="tree-item-title">What will you learn?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#What_do_you_need?"><div class="tree-item-contents heading-link" heading-name="What do you need?"><span class="tree-item-title">What do you need?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#How_long_does_it_take?"><div class="tree-item-contents heading-link" heading-name="How long does it take?"><span class="tree-item-title">How long does it take?</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#How_to_run_the_examples?"><div class="tree-item-contents heading-link" heading-name="How to run the examples?"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">How to run the examples?</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Interactive_evaluation"><div class="tree-item-contents heading-link" heading-name="Interactive evaluation"><span class="tree-item-title">Interactive evaluation</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Evaluating_Nix_files"><div class="tree-item-contents heading-link" heading-name="Evaluating Nix files"><span class="tree-item-title">Evaluating Nix files</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Notes_on_whitespace"><div class="tree-item-contents heading-link" heading-name="Notes on whitespace"><span class="tree-item-title">Notes on whitespace</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Names_and_values"><div class="tree-item-contents heading-link" heading-name="Names and values"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Names and values</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Attribute_set_`{_..._}`"><div class="tree-item-contents heading-link" heading-name="Attribute set `{ ... }`"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Attribute set <code>{ ... }</code></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Recursive_attribute_set_`rec_{_..._}`"><div class="tree-item-contents heading-link" heading-name="Recursive attribute set `rec { ... }`"><span class="tree-item-title">Recursive attribute set <code>rec { ... }</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#`let_..._in_...`"><div class="tree-item-contents heading-link" heading-name="`let ... in ...`"><span class="tree-item-title"><code>let ... in ...</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Attribute_access"><div class="tree-item-contents heading-link" heading-name="Attribute access"><span class="tree-item-title">Attribute access</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#`with_...;_...`"><div class="tree-item-contents heading-link" heading-name="`with ...; ...`"><span class="tree-item-title"><code>with ...; ...</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#`inherit_...`"><div class="tree-item-contents heading-link" heading-name="`inherit ...`"><span class="tree-item-title"><code>inherit ...</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#String_interpolation_`${_..._}`"><div class="tree-item-contents heading-link" heading-name="String interpolation `${ ... }`"><span class="tree-item-title">String interpolation <code>${ ... }</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#File_system_paths"><div class="tree-item-contents heading-link" heading-name="File system paths"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">File system paths</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Lookup_paths"><div class="tree-item-contents heading-link" heading-name="Lookup paths"><span class="tree-item-title">Lookup paths</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Indented_strings"><div class="tree-item-contents heading-link" heading-name="Indented strings"><span class="tree-item-title">Indented strings</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Functions"><div class="tree-item-contents heading-link" heading-name="Functions"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Functions</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Calling_functions"><div class="tree-item-contents heading-link" heading-name="Calling functions"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Calling functions</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Multiple_arguments"><div class="tree-item-contents heading-link" heading-name="Multiple arguments"><span class="tree-item-title">Multiple arguments</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Attribute_set_argument"><div class="tree-item-contents heading-link" heading-name="Attribute set argument"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Attribute set argument</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Default_values"><div class="tree-item-contents heading-link" heading-name="Default values"><span class="tree-item-title">Default values</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#Additional_attributes"><div class="tree-item-contents heading-link" heading-name="Additional attributes"><span class="tree-item-title">Additional attributes</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Named_attribute_set_argument"><div class="tree-item-contents heading-link" heading-name="Named attribute set argument"><span class="tree-item-title">Named attribute set argument</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Function_libraries"><div class="tree-item-contents heading-link" heading-name="Function libraries"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Function libraries</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="nix/nix-language.html#`builtins`"><div class="tree-item-contents heading-link" heading-name="`builtins`"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><code>builtins</code></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="nix/nix-language.html#`import`"><div class="tree-item-contents heading-link" heading-name="`import`"><span class="tree-item-title"><code>import</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#`pkgs.lib`"><div class="tree-item-contents heading-link" heading-name="`pkgs.lib`"><span class="tree-item-title"><code>pkgs.lib</code></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Impurities"><div class="tree-item-contents heading-link" heading-name="Impurities"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Impurities</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Paths"><div class="tree-item-contents heading-link" heading-name="Paths"><span class="tree-item-title">Paths</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Fetchers"><div class="tree-item-contents heading-link" heading-name="Fetchers"><span class="tree-item-title">Fetchers</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Derivations"><div class="tree-item-contents heading-link" heading-name="Derivations"><span class="tree-item-title">Derivations</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Worked_examples"><div class="tree-item-contents heading-link" heading-name="Worked examples"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Worked examples</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Shell_environment"><div class="tree-item-contents heading-link" heading-name="Shell environment"><span class="tree-item-title">Shell environment</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#NixOS_configuration"><div class="tree-item-contents heading-link" heading-name="NixOS configuration"><span class="tree-item-title">NixOS configuration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Package"><div class="tree-item-contents heading-link" heading-name="Package"><span class="tree-item-title">Package</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="nix/nix-language.html#References"><div class="tree-item-contents heading-link" heading-name="References"><span class="tree-item-title">References</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="nix/nix-language.html#Next_steps"><div class="tree-item-contents heading-link" heading-name="Next steps"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Next steps</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Get_things_done"><div class="tree-item-contents heading-link" heading-name="Get things done"><span class="tree-item-title">Get things done</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="nix/nix-language.html#Learn_more"><div class="tree-item-contents heading-link" heading-name="Learn more"><span class="tree-item-title">Learn more</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>